/* { dg-do run } */
/* { dg-additional-options "-O3" } */
/* { dg-skip-if "test vectorization using rvv" { *-*-* } { "*" } { "-march=rv*gc*v*zfh*" } } */

#include <stdio.h>
#include <stdlib.h>

#define LEN1 		4
#define LEN2 		2
#define LEN3 		2
#define LEN4		16

float in1[LEN3][LEN2][LEN4] = {
		{
		{
		0.000000000000, 0.308865562500, 0.587527562500, 0.808736000000, 0.950859500000, 0.999999687500, 0.951351375000, 0.809671812500, 0.588815500000, 0.310379937500, 0.001592548000, -0.307350343800, -0.586237937500, -0.807798125000, -0.950365125000, -0.999997125000, },
		{
		0.000000000000, 0.587527562500, 0.950859500000, 0.951351375000, 0.588815500000, 0.001592548000, -0.586237937500, -0.950365125000, -0.951840812500, -0.590102125000, -0.003185091875, 0.584947000000, 0.949868312500, 0.952328062500, 0.591387312500, 0.004777866563, },
		},
		{
		{
		0.000000000000, 0.587527562500, 0.950859500000, 0.951351375000, 0.588815500000, 0.001592548000, -0.586237937500, -0.950365125000, -0.951840812500, -0.590102125000, -0.003185091875, 0.584947000000, 0.949868312500, 0.952328062500, 0.591387312500, 0.004777866563, },
		{
		0.000000000000, 0.950859500000, 0.588815500000, -0.586237937500, -0.951840812500, -0.003185091875, 0.949868312500, 0.591387312500, -0.583654750000, -0.952812687500, -0.006370151875, 0.948867687500, 0.593953125000, -0.581064312500, -0.953774875000, -0.009555623750, },
		},
		};
float in2[LEN1][LEN4]= {
		{
		0.000000000000, 0.308865562500, 0.587527562500, 0.808736000000, 0.950859500000, 0.999999687500, 0.951351375000, 0.809671812500, 0.588815500000, 0.310379937500, 0.001592548000, -0.307350343800, -0.586237937500, -0.807798125000, -0.950365125000, -0.999997125000, },
		{
		0.000000000000, 0.587527562500, 0.950859500000, 0.951351375000, 0.588815500000, 0.001592548000, -0.586237937500, -0.950365125000, -0.951840812500, -0.590102125000, -0.003185091875, 0.584947000000, 0.949868312500, 0.952328062500, 0.591387312500, 0.004777866563, },
		{
		0.000000000000, 0.808736000000, 0.951351375000, 0.310379937500, -0.586237937500, -0.999997125000, -0.590102125000, 0.305834250000, 0.949868312500, 0.811537250000, 0.004777866563, -0.805916875000, -0.952812687500, -0.314918062500, 0.582360250000, 0.999974312500, },
		{
		0.000000000000, 0.950859500000, 0.588815500000, -0.586237937500, -0.951840812500, -0.003185091875, 0.949868312500, 0.591387312500, -0.583654750000, -0.952812687500, -0.006370151875, 0.948867687500, 0.593953125000, -0.581064312500, -0.953774875000, -0.009555623750, },
		};

float exp_out[LEN1][LEN3][LEN2][LEN4] = {
		{
		{
		{
		0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000 },
		{
		0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000 },
		},
		{
		{
		0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000 },
		{
		0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000 },
		},
		},
		{
		{
		{
		0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000 },
		{
		0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000 },
		},
		{
		{
		5.523018500000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000 },
		{
		8.938498000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000 },
		},
		},
		{
		{
		{
		0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000 },
		{
		0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000 },
		},
		{
		{
		12.303908750000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000 },
		{
		7.619141000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000 },
		},
		},
		{
		{
		{
		0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000 },
		{
		0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000 },
		},
		{
		{
		14.473621250000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000 },
		{
		-8.918878000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000 },
		},
		},
		};

float out[LEN1][LEN3][LEN2][LEN4];

int main(int argc, char *argv[]) {
int32_t i = 0, j = 0, k = 0, l = 0;

	for (i = 0; i < LEN1; i++) {
		for (j = 0; j < LEN3; j++) {
			for (k = 0; k < LEN2; k++) {
				out[i][j][k][0] = 0;
				for (l = 0; l < LEN4; l++) {
					out[i][j][k][0] += in1[j][k][i]*in2[i][j];
				}
			}
		}
	}

	for (i = 0; i < LEN1; i++) {
			for (j = 0; j < LEN3; j++) {
				for (k = 0; k < LEN2; k++) {
					for (l = 0; l < LEN4; l++) {
						if (abs(out[i][j][k][l] - exp_out[i][j][k][l]) > 0.0001)
							printf("Failed at out[%d][%d][%d][%d] = %.12f, Exp_out = %.12f\n",
									i,j,k,l,out[i][j][k][l],exp_out[i][j][k][l]);
					}
				}
			}
		}


	return 0;
}
